# shield-job

> 基于队列的分布式任务调度及分发中间件，based on RocketMQ

## 结构

| 项目 | 描述 | 功能 |
|  :------ |  :------ |  :------ |
| shield-job-common | shield任务调度核心 | 
| shield-job-scheduler-core | shield任务核心 |
| shield-job-example | shield任务调度示例 |

## 特性
1. 基于RocketMQ实现任务分发，可与定时调度进行无缝集成
2. 解析发送返回体，业务层做后续处理等
3. 多种消息存储设施，目前实现基于Redis队列的消息存储重发
TODO
### 任务生产执行器
1. 定时投递支持，通过开关参数进行配置
2. 队列降级支持，通过降级开关在内部降级到Redis队列
3. 引入zookeeper作为协调器，对生产和消费做协调，通知消费降级
### 任务消费执行器
1. 实现队任务消费的重发，做重发表，重发阈值可定义，重发使用线程池

        1. 定义消息重发存储接口
        2. 实现Redis/MySQL版本的存储及重发
        3. 核心功能为消息存储、重发计数、消费成功后删除、死信状态标记
        4. 认为重发队列三次后为死信，入Redis的死信队列。
    
2. 对日志做降级或者考虑自带日志管理
### 其他
1. 扩展任务分发网关
2. 对任务参数进行管理，通过枚举的方式规范参数
3. 文档和demo整理
4. 消息状态查询后台
5. 转储消息,需要在重发任务调度器中完成标记死信以及定时删除消费成功的消息的功能
6. 判断数据库中存储的当前消息的后台线程重提交次数，如果大于最大重发阈值，则不再重发，放入死信队列，直接返回
